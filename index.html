<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>索赔与理赔复习测试 - 商务函件</title>
    <style>
        /* CSS样式部分 - 现代商务风格 */
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            font-size: 20px; /* 字体大小约20号大 */
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
        h1 {
            color: #004d40; /* 商务绿色 */
            text-align: center;
            border-bottom: 3px solid #004d40;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        .user-info label {
            display: inline-block;
            margin-right: 15px;
            color: #333;
            font-weight: bold;
        }
        .user-info input[type="text"] {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin-right: 30px;
            font-size: 18px;
            width: 200px;
        }
        .question-section {
            margin-top: 25px;
            padding: 15px;
            border: 1px dashed #cccccc;
            border-radius: 6px;
        }
        h2 {
            color: #00796b; /* 强调色 */
            font-size: 22px;
            margin-top: 0;
        }
        .question-item {
            margin-bottom: 20px;
            padding: 10px 0;
            border-bottom: 1px dotted #e0e0e0;
        }
        .question-text {
            color: #333333; /* 题目颜色 */
            font-weight: bold;
            margin-bottom: 10px;
            line-height: 1.2; /* 行距约1.2 */
        }
        .options label {
            display: block;
            margin: 5px 0;
            cursor: pointer;
            color: #555555; /* 选项颜色 */
            padding: 5px;
            border-radius: 3px;
            transition: background-color 0.2s;
        }
        .options label:hover {
            background-color: #e0f2f1;
        }
        .submit-btn {
            display: block;
            width: 200px;
            padding: 15px;
            margin: 30px auto;
            background-color: #004d40;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 20px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .submit-btn:hover {
            background-color: #00251a;
        }
        #result {
            margin-top: 30px;
            padding: 20px;
            border: 2px solid #004d40;
            border-radius: 5px;
            background-color: #e0f2f1;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            display: none;
        }
        #result span {
            color: #d84315; /* 红色强调分数 */
            margin: 0 5px;
        }

        /* 连线题特殊样式 */
        .matching-table {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
            margin-bottom: 20px;
        }
        .matching-table th, .matching-table td {
            border: 1px solid #ddd;
            padding: 12px;
        }
        .matching-table th {
            background-color: #f5f5f5;
            color: #00796b;
        }
        .matching-table input[type="text"] {
            width: 50px;
            padding: 8px;
            text-align: center;
            font-size: 18px;
            border: 1px solid #00796b;
            text-transform: uppercase; /* 自动转换为大写，方便输入 */
        }
    </style>
</head>
<body>

<div class="container">
    <h1>索赔与理赔复习测试</h1>

    <div class="user-info">
        <label for="studentName">姓名:</label>
        <input type="text" id="studentName" placeholder="请填写姓名">

        <label for="studentID">学号:</label>
        <input type="text" id="studentID" placeholder="请填写学号">
    </div>

    <form id="testForm">
        </form>

    <button type="button" class="submit-btn" onclick="calculateScore()">提交测试</button>

    <div id="result">
        <p>考生：<span id="resName"></span> (学号：<span id="resID"></span>)</p>
        <p>您的最终得分是：<span id="scoreDisplay"></span> 分</p>
        <p style="font-size:16px; color:#d84315;">* 组词成句题的自动评分机制仅供参考，若答案与标准句式结构略有不同，建议人工复核。</p>
    </div>

</div>

<script>
    // JavaScript 逻辑部分 - 包含数据、随机化和评分逻辑

    // 1. 选择填空题 (10 题)
    const fillInQuestions = [
        {
            text: "索赔是指在合同履行过程中，因为当事人一方没有按照合同规定履行义务而**（ ）**的一方向对方提出赔偿要求的行为。",
            options: ["A. 造成损失", "B. 受到损失", "C. 弥补损失", "D. 避免损失"],
            answer: "B" 
        },
        {
            text: "（ ）是指接受赔偿要求并确定赔偿数额和方法的行为。",
            options: ["A. 索赔", "B. 检验", "C. 追查", "D. 理赔"],
            answer: "D" 
        },
        {
            text: "下列哪项不是常见的索赔情况？",
            options: ["A. 包装损坏", "B. 货物缺失短少", "C. 质量没有达到合同要求", "D. 合同按时履行完毕"],
            answer: "D" 
        },
        {
            text: "索赔和理赔的原则是“有理决不让步，（ ）”。",
            options: ["A. 无理决不拒绝", "B. 无理决不强求", "C. 无理决不让步", "D. 有理决不强求"],
            answer: "B" 
        },
        {
            text: "提出索赔的一方必须事先做好详细的调查，并由（ ）出具检验报告，作为索赔的依据。",
            options: ["A. 卖方指定的机构", "B. 任意检验机构", "C. 能被认可的检验机构", "D. 运输公司"],
            answer: "C" 
        },
        {
            text: "在索赔信中，提出具体解决方法之前，通常需要指出因对方违约给己方带来了（ ）。",
            options: ["A. 额外盈利", "B. 不便与损失", "C. 额外的合作机会", "D. 弥补"],
            answer: "B" 
        },
        {
            text: "如果理赔方不能立即处理对方的索赔，要马上（ ）接到了索赔信，并告诉对方将对此事进行调查。",
            options: ["A. 承认", "B. 追查", "C. 遗漏", "D. 弥补"],
            answer: "A" 
        },
        {
            text: "在国际贸易的索赔过程中，提出索赔的一方常常是（ ）。",
            options: ["A. 卖方", "B. 银行", "C. 买方", "D. 运输公司"],
            answer: "C" 
        },
        {
            text: "如果对方的索赔不成立，理赔信中应（ ）。",
            options: ["A. 对具体赔偿要求进行认真核算", "B. 提出不能接受其索赔的原因", "C. 表示深为关切并立即处理", "D. 承诺将不另收费"],
            answer: "B" 
        },
        {
            text: "无论是索赔信还是理赔信，在撰写时都必须注意（ ），这是商务信函的基本要求。",
            options: ["A. 强制性", "B. 盈利性", "C. 礼貌性", "D. 模糊性"],
            answer: "C" 
        }
    ];

    // 2. 连线题 (10 题)
    const matchingData = [
        { formal: "收悉", meaning: "收到（信件）", code: "E" },
        { formal: "遗漏", meaning: "犯错误、不准确、不规范等", code: "I" },
        { formal: "深为关切", meaning: "非常关心", code: "A" },
        { formal: "系", meaning: "是", code: "C" },
        { formal: "追查", meaning: "仔细、认真检查", code: "D" },
        { formal: "仅此一次", meaning: "就这样一次", code: "J" },
        { formal: "不可抗力", meaning: "没有办法控制的、预知的（因素）", code: "G" },
        { formal: "有失公平", meaning: "不太公平", code: "F" },
        { formal: "弥补", meaning: "补充", code: "B" },
        { formal: "不另收费", meaning: "不再收费", code: "H" }
    ];
    // 连线题的选项（右栏）
    const matchingOptions = [
        { code: "A", meaning: "非常关心" },
        { code: "B", meaning: "补充" },
        { code: "C", meaning: "是" },
        { code: "D", meaning: "仔细、认真检查" },
        { code: "E", meaning: "收到（信件）" },
        { code: "F", meaning: "不太公平" },
        { code: "G", meaning: "没有办法控制的、预知的（因素）" },
        { code: "H", meaning: "不再收费" },
        { code: "I", meaning: "犯错误、不准确、不规范等" },
        { code: "J", meaning: "就这样一次" }
    ];


    // 3. 组词成句题 (10 题) - 答案需要包含的核心关键词
    const sentenceQuestions = [
        { words: "收悉 / 贵方 / 索赔信 / 订单 / 关于", answer: "我方已收悉贵方关于订单的索赔信。", keywords: ["收悉", "贵方", "索赔信", "订单"] },
        { words: "不当包装 / 造成 / 损失 / 由于 / 所致 / 是", answer: "损失是由于不当包装所致。", keywords: ["损失", "不当包装", "所致"] },
        { words: "调查 / 立即 / 我们 / 将 / 此事 / 对 / 进行", answer: "我们将立即对此事进行调查。", keywords: ["立即", "对此事", "进行调查"] },
        { words: "理赔 / 原则 / 决不让步 / 有理 / 索赔 / 的", answer: "索赔和理赔的原则是有理决不让步，无理决不强求。", keywords: ["原则", "有理", "决不让步", "无理", "决不强求"] },
        { words: "质量 / 检验报告 / 合同要求 / 未达到 / 附 / 我方 / 的", answer: "我方附上货物质量未达到合同要求的检验报告。", keywords: ["附上", "检验报告", "未达到", "合同要求"] },
        { words: "潮湿 / 问题 / 牛仔裤 / 贵批 / 存在 / 明显", answer: "贵批牛仔裤存在明显潮湿问题。", keywords: ["贵批", "牛仔裤", "潮湿", "明显"] },
        { words: "退货 / 要求 / 赔偿 / 提出 / 我方 / 具体 / 并", answer: "我方提出具体的退货并赔偿要求。", keywords: ["提出", "具体", "退货", "赔偿要求"] },
        { words: "不成立 / 索赔 / 对方 / 拒绝 / 我方 / 只能 / 因此", answer: "因对方索赔不成立，我方只能拒绝。", keywords: ["索赔不成立", "只能", "拒绝"] },
        { words: "弥补 / 遗憾 / 造成 / 给 / 贵方 / 额外 / 我们 / 损失 / 的", answer: "我们将采取措施弥补给贵方造成的额外损失。", keywords: ["弥补", "造成", "额外损失"] },
        { words: "贵方 / 单独 / 承担 / 有失公平 / 责任 / 若", answer: "若贵方单独承担责任，恐有失公平。", keywords: ["单独", "承担责任", "有失公平"] }
    ];

    // 随机打乱数组的通用函数
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    // 渲染选择填空题
    function renderFillIn(container) {
        shuffleArray(fillInQuestions);
        let html = '<div class="question-section"><h2>一、选择填空（共 10 题）</h2>';
        fillInQuestions.forEach((q, index) => {
            const optionsWithAnswer = q.options.map(opt => ({ text: opt, value: opt.charAt(0) }));
            shuffleArray(optionsWithAnswer);

            html += `<div class="question-item">
                        <p class="question-text">${index + 1}. ${q.text}</p>
                        <div class="options">`;
            
            optionsWithAnswer.forEach(opt => {
                html += `<label><input type="radio" name="fillin_${index}" value="${opt.value}">${opt.text}</label>`;
            });

            html += `   </div>
                    </div>`;
        });
        container.innerHTML += html + '</div>';
    }

    // 渲染连线题
    function renderMatching(container) {
        shuffleArray(matchingData); // 打乱左栏的正式表达
        shuffleArray(matchingOptions); // 打乱右栏的注释意义

        let html = `<div class="question-section">
                        <h2>二、连线题（共 10 题）</h2>
                        <p>请将左栏的**正式表达**与右栏的**注释意义**进行匹配。在左栏的输入框中填写右栏对应的**字母代码**。</p>
                        <table class="matching-table">
                            <thead>
                                <tr><th>序号</th><th>正式表达（左栏）</th><th>匹配代码</th><th>字母代码</th><th>注释意义（右栏）</th></tr>
                            </thead>
                            <tbody>`;
        
        for (let i = 0; i < matchingData.length; i++) {
            const leftItem = matchingData[i];
            const rightItem = matchingOptions[i];

            html += `<tr>
                        <td>${i + 1}</td>
                        <td>${leftItem.formal}</td>
                        <td><input type="text" maxlength="1" id="match_${i}"></td>
                        <td>${rightItem.code}</td>
                        <td>${rightItem.meaning}</td>
                    </tr>`;
        }

        html += `   </tbody></table></div>`;
        container.innerHTML += html;
    }

    // 渲染组词成句题
    function renderSentence(container) {
        shuffleArray(sentenceQuestions);
        let html = `<div class="question-section">
                        <h2>三、组词成句（共 10 题）</h2>
                        <p>请将下列词语重新组合成一个完整、语法正确且符合商务信函语境的句子。</p>`;
        sentenceQuestions.forEach((q, index) => {
            html += `<div class="question-item">
                        <p class="question-text">${index + 1}. 词语：${q.words}</p>
                        <p>答案：<input type="text" id="sentence_${index}" style="width: 80%; padding: 10px; font-size: 18px;"></p>
                    </div>`;
        });
        container.innerHTML += html + '</div>';
    }

    // 初始化测试题
    function initTest() {
        const form = document.getElementById('testForm');
        form.innerHTML = ''; // 清空原有内容
        renderFillIn(form);
        renderMatching(form);
        renderSentence(form);
    }

    // 计算得分
    function calculateScore() {
        const studentName = document.getElementById('studentName').value.trim();
        const studentID = document.getElementById('studentID').value.trim();
        
        if (!studentName || !studentID) {
            alert('请填写姓名和学号！');
            return;
        }

        let correctCount = 0; // 记录答对小题数 (总共 30 题)

        // 1. 评分：选择填空题 (10 题)
        fillInQuestions.forEach((q, index) => {
            const selectedOption = document.querySelector(`input[name="fillin_${index}"]:checked`);
            if (selectedOption && selectedOption.value === q.answer) {
                correctCount += 1;
            }
        });

        // 2. 评分：连线题 (10 题) - 忽略大小写
        matchingData.forEach((q, index) => {
            const inputField = document.getElementById(`match_${index}`);
            if (inputField) {
                // 关键修复：将输入值和标准答案都转换为大写进行比较
                if (inputField.value.trim().toUpperCase() === q.code.toUpperCase()) {
                    correctCount += 1;
                }
            }
        });

        // 3. 评分：组词成句题 (10 题) - 宽松评分：检查是否包含所有核心关键词
        sentenceQuestions.forEach((q, index) => {
            const inputField = document.getElementById(`sentence_${index}`);
            if (inputField) {
                const studentAnswer = inputField.value.trim().replace(/\s+/g, '').toLowerCase(); // 去除空格并小写
                
                // 检查学生答案是否包含所有关键词
                let allKeywordsFound = true;
                for (const keyword of q.keywords) {
                    if (!studentAnswer.includes(keyword.replace(/\s+/g, ''))) {
                        allKeywordsFound = false;
                        break;
                    }
                }
                
                if (allKeywordsFound) {
                    correctCount += 1;
                }
            }
        });
        
        // 最终得分计算：总共 30 道小题，每题约 0.333...分，总分 10 分。
        const finalScore = (correctCount * 10 / 30).toFixed(1);

        // 显示结果
        document.getElementById('resName').textContent = studentName;
        document.getElementById('resID').textContent = studentID;
        document.getElementById('scoreDisplay').textContent = finalScore;
        document.getElementById('result').style.display = 'block';

        // 禁用提交按钮，防止重复提交
        document.querySelector('.submit-btn').disabled = true;
    }

    // 页面加载完成后立即初始化
    window.onload = initTest;
</script>
</body>
</html>